
import styles from './HTMLNode.style'
import Node from '../core/Node'
import Transformable from '../core/Transformable'
import Sizeable from '../core/Sizeable'
import DeclarativeBase, {initDeclarativeBase, proxyGettersSetters} from './DeclarativeBase'

initDeclarativeBase()

class HTMLNode extends DeclarativeBase {
    static define(name) {
        customElements.define(name || 'i-node', HTMLNode)
    }

    getStyles() {
        return styles
    }

    // this is called by DeclarativeBase#init, which is called by
    // WebComponent#connectedCallback, at which point this element has a
    // parentNode.
    // @override
    _makeImperativeCounterpart() {
        return new Node({
            _motorHtmlCounterpart: this
        })
    }

    setAttribute(attribute, value) {
        //if (!window.count) window.count = 0
        //if (window.count++ % 100 === 0)
            //console.log(' ------ setAttribute', value)
        super.setAttribute(attribute, ""+value)
    }

    // TODO: get these from somewhere dynamically, and do same for
    // proxyGettersSetters and _updateNodeProperty
    static get observedAttributes() { return [
        'sizeMode',
        'absoluteSize',
        'proportionalSize',
        'align',
        'mountPoint',
        'rotation',
        'position',
        'scale',
        'origin',
        'skew',
        'opacity',
    ].map(a => a.toLowerCase())}

    attributeChangedCallback(...args) {
        super.attributeChangedCallback(...args)

        // TODO PERFORMANCE: we could possibly not stack a promise every
        // attribute change, and just cache the latest value to set it when the
        // imperativeCounterpart is ready.
        this._imperativeCounterpartPromise.then(() => {
            this._updateNodeProperty(...args)
        })
    }
    //async attributeChangedCallback(...args) {
        //super.attributeChangedCallback(...args)

        //// TODO PERFORMANCE: we could possibly not stack a promise every
        //// attribute change, and just cache the latest value to set it when the
        //// imperativeCounterpart is ready.
        //await this._imperativeCounterpartPromise
        //this._updateNodeProperty(...args)
    //}

    _updateNodeProperty(attribute, oldValue, newValue) {
        // attributes on our HTML elements are the same name as those on
        // the Node class (the setters).
        if (newValue !== oldValue) {
            if (attribute.match(/opacity/i))
                { this.imperativeCounterpart[attribute] = window.parseFloat(newValue) }
            else if (attribute.match(/sizeMode/i))
                { this.imperativeCounterpart[attribute] = parseStringArray(newValue) }
            else if (
                attribute.match(/rotation/i)
                || attribute.match(/scale/i)
                || attribute.match(/position/i)
                || attribute.match(/absoluteSize/i)
                || attribute.match(/proportionalSize/i)
                || attribute.match(/align/i)
                || attribute.match(/mountPoint/i)
                || attribute.match(/origin/i)
                || attribute.match(/skew/i)
            ) {
                this.imperativeCounterpart[attribute] = parseNumberArray(newValue)
            }
            else {
                /* nothing, ignore other attributes */
            }
        }
    }
}

// This associates the Transformable getters/setters with the HTML-API classes,
// so that the same getters/setters can be called from HTML side of the API.
proxyGettersSetters(Transformable, HTMLNode)
proxyGettersSetters(Sizeable, HTMLNode)

function parseNumberArray(str) {
    checkIsNumberArrayString(str)
    const numbers = str.trim().split(/(?:\s*,\s*)|(?:\s+)/g)
    const length = numbers.length
    if (length > 0) { numbers[0] = window.parseFloat(numbers[0]) }
    if (length > 1) { numbers[1] = window.parseFloat(numbers[1]) }
    if (length > 2) { numbers[2] = window.parseFloat(numbers[2]) }
    return numbers
}

function parseStringArray(str) {
    checkIsSizeArrayString(str)
    const strings = str.trim().toLowerCase().split(/(?:\s*,\s*)|(?:\s+)/g)
    const length = strings.length
    if (length > 0) { strings[0] = strings[0] }
    if (length > 1) { strings[1] = strings[1] }
    if (length > 2) { strings[2] = strings[2] }
    return strings
}

function checkIsNumberArrayString(str) {
    if (!str.match(/^\s*(((\s*(-|\+)?((\.\d+)|(\d+\.\d+)|(\d+)|(\d+(\.\d+)?e(-|\+)?(\d+)))\s*,){0,2}(\s*(-|\+)?((\.\d+)|(\d+\.\d+)|(\d+)|(\d+(\.\d+)?e(-|\+)?(\d+)))))|((\s*(-|\+)?((\.\d+)|(\d+\.\d+)|(\d+)|(\d+(\.\d+)?e(-|\+)?(\d+)))\s){0,2}(\s*(-|\+)?((\.\d+)|(\d+\.\d+)|(\d+)|(\d+(\.\d+)?e(-|\+)?(\d+))))))\s*$/g))
        { throw new Error(`Attribute must be a comma- or space-separated sequence of up to three numbers, for example "1 2.5 3". Yours was "${str}".`) }
}

function checkIsSizeArrayString(str) {
    if (!str.match(/^\s*(((\s*([a-zA-Z]+)\s*,){0,2}(\s*([a-zA-Z]+)))|((\s*([a-zA-Z]+)\s*){1,3}))\s*$/g))
        { throw new Error(`Attribute must be a comma- or space-separated sequence of up to three strings, for example "absolute absolute". Yours was "${str}".`) }
}

export {HTMLNode as default}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSFRNTE5vZGUuanMiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9odG1sL0hUTUxOb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHN0eWxlcyBmcm9tICcuL0hUTUxOb2RlLnN0eWxlJ1xuaW1wb3J0IE5vZGUgZnJvbSAnLi4vY29yZS9Ob2RlJ1xuaW1wb3J0IFRyYW5zZm9ybWFibGUgZnJvbSAnLi4vY29yZS9UcmFuc2Zvcm1hYmxlJ1xuaW1wb3J0IFNpemVhYmxlIGZyb20gJy4uL2NvcmUvU2l6ZWFibGUnXG5pbXBvcnQgRGVjbGFyYXRpdmVCYXNlLCB7aW5pdERlY2xhcmF0aXZlQmFzZSwgcHJveHlHZXR0ZXJzU2V0dGVyc30gZnJvbSAnLi9EZWNsYXJhdGl2ZUJhc2UnXG5cbmluaXREZWNsYXJhdGl2ZUJhc2UoKVxuXG5jbGFzcyBIVE1MTm9kZSBleHRlbmRzIERlY2xhcmF0aXZlQmFzZSB7XG4gICAgc3RhdGljIGRlZmluZShuYW1lKSB7XG4gICAgICAgIGN1c3RvbUVsZW1lbnRzLmRlZmluZShuYW1lIHx8ICdpLW5vZGUnLCBIVE1MTm9kZSlcbiAgICB9XG5cbiAgICBnZXRTdHlsZXMoKSB7XG4gICAgICAgIHJldHVybiBzdHlsZXNcbiAgICB9XG5cbiAgICAvLyB0aGlzIGlzIGNhbGxlZCBieSBEZWNsYXJhdGl2ZUJhc2UjaW5pdCwgd2hpY2ggaXMgY2FsbGVkIGJ5XG4gICAgLy8gV2ViQ29tcG9uZW50I2Nvbm5lY3RlZENhbGxiYWNrLCBhdCB3aGljaCBwb2ludCB0aGlzIGVsZW1lbnQgaGFzIGFcbiAgICAvLyBwYXJlbnROb2RlLlxuICAgIC8vIEBvdmVycmlkZVxuICAgIF9tYWtlSW1wZXJhdGl2ZUNvdW50ZXJwYXJ0KCkge1xuICAgICAgICByZXR1cm4gbmV3IE5vZGUoe1xuICAgICAgICAgICAgX21vdG9ySHRtbENvdW50ZXJwYXJ0OiB0aGlzXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgc2V0QXR0cmlidXRlKGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICAgICAgLy9pZiAoIXdpbmRvdy5jb3VudCkgd2luZG93LmNvdW50ID0gMFxuICAgICAgICAvL2lmICh3aW5kb3cuY291bnQrKyAlIDEwMCA9PT0gMClcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJyAtLS0tLS0gc2V0QXR0cmlidXRlJywgdmFsdWUpXG4gICAgICAgIHN1cGVyLnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIFwiXCIrdmFsdWUpXG4gICAgfVxuXG4gICAgLy8gVE9ETzogZ2V0IHRoZXNlIGZyb20gc29tZXdoZXJlIGR5bmFtaWNhbGx5LCBhbmQgZG8gc2FtZSBmb3JcbiAgICAvLyBwcm94eUdldHRlcnNTZXR0ZXJzIGFuZCBfdXBkYXRlTm9kZVByb3BlcnR5XG4gICAgc3RhdGljIGdldCBvYnNlcnZlZEF0dHJpYnV0ZXMoKSB7IHJldHVybiBbXG4gICAgICAgICdzaXplTW9kZScsXG4gICAgICAgICdhYnNvbHV0ZVNpemUnLFxuICAgICAgICAncHJvcG9ydGlvbmFsU2l6ZScsXG4gICAgICAgICdhbGlnbicsXG4gICAgICAgICdtb3VudFBvaW50JyxcbiAgICAgICAgJ3JvdGF0aW9uJyxcbiAgICAgICAgJ3Bvc2l0aW9uJyxcbiAgICAgICAgJ3NjYWxlJyxcbiAgICAgICAgJ29yaWdpbicsXG4gICAgICAgICdza2V3JyxcbiAgICAgICAgJ29wYWNpdHknLFxuICAgIF0ubWFwKGEgPT4gYS50b0xvd2VyQ2FzZSgpKX1cblxuICAgIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayguLi5hcmdzKSB7XG4gICAgICAgIHN1cGVyLmF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayguLi5hcmdzKVxuXG4gICAgICAgIC8vIFRPRE8gUEVSRk9STUFOQ0U6IHdlIGNvdWxkIHBvc3NpYmx5IG5vdCBzdGFjayBhIHByb21pc2UgZXZlcnlcbiAgICAgICAgLy8gYXR0cmlidXRlIGNoYW5nZSwgYW5kIGp1c3QgY2FjaGUgdGhlIGxhdGVzdCB2YWx1ZSB0byBzZXQgaXQgd2hlbiB0aGVcbiAgICAgICAgLy8gaW1wZXJhdGl2ZUNvdW50ZXJwYXJ0IGlzIHJlYWR5LlxuICAgICAgICB0aGlzLl9pbXBlcmF0aXZlQ291bnRlcnBhcnRQcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlTm9kZVByb3BlcnR5KC4uLmFyZ3MpXG4gICAgICAgIH0pXG4gICAgfVxuICAgIC8vYXN5bmMgYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrKC4uLmFyZ3MpIHtcbiAgICAgICAgLy9zdXBlci5hdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2soLi4uYXJncylcblxuICAgICAgICAvLy8vIFRPRE8gUEVSRk9STUFOQ0U6IHdlIGNvdWxkIHBvc3NpYmx5IG5vdCBzdGFjayBhIHByb21pc2UgZXZlcnlcbiAgICAgICAgLy8vLyBhdHRyaWJ1dGUgY2hhbmdlLCBhbmQganVzdCBjYWNoZSB0aGUgbGF0ZXN0IHZhbHVlIHRvIHNldCBpdCB3aGVuIHRoZVxuICAgICAgICAvLy8vIGltcGVyYXRpdmVDb3VudGVycGFydCBpcyByZWFkeS5cbiAgICAgICAgLy9hd2FpdCB0aGlzLl9pbXBlcmF0aXZlQ291bnRlcnBhcnRQcm9taXNlXG4gICAgICAgIC8vdGhpcy5fdXBkYXRlTm9kZVByb3BlcnR5KC4uLmFyZ3MpXG4gICAgLy99XG5cbiAgICBfdXBkYXRlTm9kZVByb3BlcnR5KGF0dHJpYnV0ZSwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIC8vIGF0dHJpYnV0ZXMgb24gb3VyIEhUTUwgZWxlbWVudHMgYXJlIHRoZSBzYW1lIG5hbWUgYXMgdGhvc2Ugb25cbiAgICAgICAgLy8gdGhlIE5vZGUgY2xhc3MgKHRoZSBzZXR0ZXJzKS5cbiAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5tYXRjaCgvb3BhY2l0eS9pKSlcbiAgICAgICAgICAgICAgICB0aGlzLmltcGVyYXRpdmVDb3VudGVycGFydFthdHRyaWJ1dGVdID0gd2luZG93LnBhcnNlRmxvYXQobmV3VmFsdWUpXG4gICAgICAgICAgICBlbHNlIGlmIChhdHRyaWJ1dGUubWF0Y2goL3NpemVNb2RlL2kpKVxuICAgICAgICAgICAgICAgIHRoaXMuaW1wZXJhdGl2ZUNvdW50ZXJwYXJ0W2F0dHJpYnV0ZV0gPSBwYXJzZVN0cmluZ0FycmF5KG5ld1ZhbHVlKVxuICAgICAgICAgICAgZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlLm1hdGNoKC9yb3RhdGlvbi9pKVxuICAgICAgICAgICAgICAgIHx8IGF0dHJpYnV0ZS5tYXRjaCgvc2NhbGUvaSlcbiAgICAgICAgICAgICAgICB8fCBhdHRyaWJ1dGUubWF0Y2goL3Bvc2l0aW9uL2kpXG4gICAgICAgICAgICAgICAgfHwgYXR0cmlidXRlLm1hdGNoKC9hYnNvbHV0ZVNpemUvaSlcbiAgICAgICAgICAgICAgICB8fCBhdHRyaWJ1dGUubWF0Y2goL3Byb3BvcnRpb25hbFNpemUvaSlcbiAgICAgICAgICAgICAgICB8fCBhdHRyaWJ1dGUubWF0Y2goL2FsaWduL2kpXG4gICAgICAgICAgICAgICAgfHwgYXR0cmlidXRlLm1hdGNoKC9tb3VudFBvaW50L2kpXG4gICAgICAgICAgICAgICAgfHwgYXR0cmlidXRlLm1hdGNoKC9vcmlnaW4vaSlcbiAgICAgICAgICAgICAgICB8fCBhdHRyaWJ1dGUubWF0Y2goL3NrZXcvaSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW1wZXJhdGl2ZUNvdW50ZXJwYXJ0W2F0dHJpYnV0ZV0gPSBwYXJzZU51bWJlckFycmF5KG5ld1ZhbHVlKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLyogbm90aGluZywgaWdub3JlIG90aGVyIGF0dHJpYnV0ZXMgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8gVGhpcyBhc3NvY2lhdGVzIHRoZSBUcmFuc2Zvcm1hYmxlIGdldHRlcnMvc2V0dGVycyB3aXRoIHRoZSBIVE1MLUFQSSBjbGFzc2VzLFxuLy8gc28gdGhhdCB0aGUgc2FtZSBnZXR0ZXJzL3NldHRlcnMgY2FuIGJlIGNhbGxlZCBmcm9tIEhUTUwgc2lkZSBvZiB0aGUgQVBJLlxucHJveHlHZXR0ZXJzU2V0dGVycyhUcmFuc2Zvcm1hYmxlLCBIVE1MTm9kZSlcbnByb3h5R2V0dGVyc1NldHRlcnMoU2l6ZWFibGUsIEhUTUxOb2RlKVxuXG5mdW5jdGlvbiBwYXJzZU51bWJlckFycmF5KHN0cikge1xuICAgIGNoZWNrSXNOdW1iZXJBcnJheVN0cmluZyhzdHIpXG4gICAgY29uc3QgbnVtYmVycyA9IHN0ci50cmltKCkuc3BsaXQoLyg/OlxccyosXFxzKil8KD86XFxzKykvZylcbiAgICBjb25zdCBsZW5ndGggPSBudW1iZXJzLmxlbmd0aFxuICAgIGlmIChsZW5ndGggPiAwKSBudW1iZXJzWzBdID0gd2luZG93LnBhcnNlRmxvYXQobnVtYmVyc1swXSlcbiAgICBpZiAobGVuZ3RoID4gMSkgbnVtYmVyc1sxXSA9IHdpbmRvdy5wYXJzZUZsb2F0KG51bWJlcnNbMV0pXG4gICAgaWYgKGxlbmd0aCA+IDIpIG51bWJlcnNbMl0gPSB3aW5kb3cucGFyc2VGbG9hdChudW1iZXJzWzJdKVxuICAgIHJldHVybiBudW1iZXJzXG59XG5cbmZ1bmN0aW9uIHBhcnNlU3RyaW5nQXJyYXkoc3RyKSB7XG4gICAgY2hlY2tJc1NpemVBcnJheVN0cmluZyhzdHIpXG4gICAgY29uc3Qgc3RyaW5ncyA9IHN0ci50cmltKCkudG9Mb3dlckNhc2UoKS5zcGxpdCgvKD86XFxzKixcXHMqKXwoPzpcXHMrKS9nKVxuICAgIGNvbnN0IGxlbmd0aCA9IHN0cmluZ3MubGVuZ3RoXG4gICAgaWYgKGxlbmd0aCA+IDApIHN0cmluZ3NbMF0gPSBzdHJpbmdzWzBdXG4gICAgaWYgKGxlbmd0aCA+IDEpIHN0cmluZ3NbMV0gPSBzdHJpbmdzWzFdXG4gICAgaWYgKGxlbmd0aCA+IDIpIHN0cmluZ3NbMl0gPSBzdHJpbmdzWzJdXG4gICAgcmV0dXJuIHN0cmluZ3Ncbn1cblxuZnVuY3Rpb24gY2hlY2tJc051bWJlckFycmF5U3RyaW5nKHN0cikge1xuICAgIGlmICghc3RyLm1hdGNoKC9eXFxzKigoKFxccyooLXxcXCspPygoXFwuXFxkKyl8KFxcZCtcXC5cXGQrKXwoXFxkKyl8KFxcZCsoXFwuXFxkKyk/ZSgtfFxcKyk/KFxcZCspKSlcXHMqLCl7MCwyfShcXHMqKC18XFwrKT8oKFxcLlxcZCspfChcXGQrXFwuXFxkKyl8KFxcZCspfChcXGQrKFxcLlxcZCspP2UoLXxcXCspPyhcXGQrKSkpKSl8KChcXHMqKC18XFwrKT8oKFxcLlxcZCspfChcXGQrXFwuXFxkKyl8KFxcZCspfChcXGQrKFxcLlxcZCspP2UoLXxcXCspPyhcXGQrKSkpXFxzKXswLDJ9KFxccyooLXxcXCspPygoXFwuXFxkKyl8KFxcZCtcXC5cXGQrKXwoXFxkKyl8KFxcZCsoXFwuXFxkKyk/ZSgtfFxcKyk/KFxcZCspKSkpKSlcXHMqJC9nKSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBdHRyaWJ1dGUgbXVzdCBiZSBhIGNvbW1hLSBvciBzcGFjZS1zZXBhcmF0ZWQgc2VxdWVuY2Ugb2YgdXAgdG8gdGhyZWUgbnVtYmVycywgZm9yIGV4YW1wbGUgXCIxIDIuNSAzXCIuIFlvdXJzIHdhcyBcIiR7c3RyfVwiLmApXG59XG5cbmZ1bmN0aW9uIGNoZWNrSXNTaXplQXJyYXlTdHJpbmcoc3RyKSB7XG4gICAgaWYgKCFzdHIubWF0Y2goL15cXHMqKCgoXFxzKihbYS16QS1aXSspXFxzKiwpezAsMn0oXFxzKihbYS16QS1aXSspKSl8KChcXHMqKFthLXpBLVpdKylcXHMqKXsxLDN9KSlcXHMqJC9nKSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBdHRyaWJ1dGUgbXVzdCBiZSBhIGNvbW1hLSBvciBzcGFjZS1zZXBhcmF0ZWQgc2VxdWVuY2Ugb2YgdXAgdG8gdGhyZWUgc3RyaW5ncywgZm9yIGV4YW1wbGUgXCJhYnNvbHV0ZSBhYnNvbHV0ZVwiLiBZb3VycyB3YXMgXCIke3N0cn1cIi5gKVxufVxuXG5leHBvcnQge0hUTUxOb2RlIGFzIGRlZmF1bHR9XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQSxPQUFPLE1BQU0sTUFBTSxrQkFBa0I7QUFDckMsT0FBTyxJQUFJLE1BQU0sY0FBYztBQUMvQixPQUFPLGFBQWEsTUFBTSx1QkFBdUI7QUFDakQsT0FBTyxRQUFRLE1BQU0sa0JBQWtCO0FBQ3ZDLE9BQU8sZUFBZSxHQUFHLG1CQUFtQixFQUFFLG1CQUFtQixPQUFPLG1CQUFtQjs7QUFFM0YsbUJBQW1CLEVBQUU7O0FBRXJCLE1BQU0sUUFBUSxTQUFTLGVBQWUsQ0FBQztJQUNuQyxPQUFPLE1BQU0sQ0FBQyxJQUFJLEVBQUU7UUFDaEIsY0FBYyxDQUFDLE1BQU0sQ0FBQyxJQUFJLElBQUksUUFBUSxFQUFFLFFBQVEsQ0FBQztLQUNwRDs7SUFFRCxTQUFTLEdBQUc7UUFDUixPQUFPLE1BQU07S0FDaEI7Ozs7OztJQU1ELDBCQUEwQixHQUFHO1FBQ3pCLE9BQU8sSUFBSSxJQUFJLENBQUM7WUFDWixxQkFBcUIsRUFBRSxJQUFJO1NBQzlCLENBQUM7S0FDTDs7SUFFRCxZQUFZLENBQUMsU0FBUyxFQUFFLEtBQUssRUFBRTs7OztRQUkzQixLQUFLLENBQUMsWUFBWSxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDO0tBQzFDOzs7O0lBSUQsV0FBVyxrQkFBa0IsR0FBRyxFQUFFLE9BQU87UUFDckMsVUFBVTtRQUNWLGNBQWM7UUFDZCxrQkFBa0I7UUFDbEIsT0FBTztRQUNQLFlBQVk7UUFDWixVQUFVO1FBQ1YsVUFBVTtRQUNWLE9BQU87UUFDUCxRQUFRO1FBQ1IsTUFBTTtRQUNOLFNBQVM7S0FDWixDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7O0lBRTVCLHdCQUF3QixDQUFDLEdBQUcsSUFBSSxFQUFFO1FBQzlCLEtBQUssQ0FBQyx3QkFBd0IsQ0FBQyxHQUFHLElBQUksQ0FB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