{"version":3,"file":"ElementManager.js","sources":["../../src/core/ElementManager.js"],"sourcesContent":["import Node from './Node'\nimport Motor from './Motor'\n\n/**\n * Manages a DOM element. Exposes a set of recommended APIs for working with\n * DOM efficiently. Currently doesn't do much yet...\n */\nclass ElementManager {\n    constructor(element) {\n        this.element = element\n    }\n\n    /**\n     * @param {Array.string} classes An array of class names to add to the\n     * managed element.\n     *\n     * Note: updating class names with `el.classList.add()` won't thrash the\n     * layout. See: http://www.html5rocks.com/en/tutorials/speed/animations\n     */\n    setClasses (...classes) {\n        if (classes.length) this.element.classList.add(...classes)\n        return this\n    }\n\n    /**\n     * Apply a style property to the element.\n     *\n     * @private\n     * @param  {string} property The CSS property we will a apply.\n     * @param  {string} value    The value the CSS property wil have.\n     */\n    applyStyle(property, value) {\n        this.element.style[property] = value\n    }\n\n    addChild(childElementManager) {\n        this.element.appendChild(childElementManager.element)\n    }\n\n    removeChild(childElementManager) {\n        // This conditional check is needed incase the element was already\n        // removed from the HTML-API side.\n        if (childElementManager.element.parentNode === this.element)\n            this.element.removeChild(childElementManager.element)\n    }\n\n    connectChildElement(childImperativeNode) {\n        if (\n\n            // When using the imperative API, this statement is\n            // true, so the DOM elements need to be connected.\n            !childImperativeNode._elementManager.element.parentNode\n\n            // This condition is irrelevant when strictly using the\n            // imperative API. However, it is possible that when\n            // using the HTML API that the HTML-API node can be placed\n            // somewhere that isn't another HTML-API node, and the\n            // imperative Node can be gotten and used to add the\n            // node to another imperative Node. In this case, the\n            // HTML-API node will be added to the proper HTMLparent.\n            || (childImperativeNode._elementManager.element.parentElement &&\n                childImperativeNode._elementManager.element.parentElement !== this.element)\n\n            // When an HTML-API node is already child of the\n            // relevant parent, or it is child of a shadow root of\n            // the relevant parent, there there's nothing to do,\n            // everything is already as expected, so the following\n            // conditional body is skipped.\n        ) {\n            this.addChild(childImperativeNode._elementManager)\n        }\n    }\n\n    disconnectChildElement(childImperativeNode) {\n        // If DeclarativeBase#removeChild was called first, we don't need to\n        // call this again.\n        if (!childImperativeNode._elementManager.element.parentNode) return\n\n        this.removeChild(childImperativeNode._elementManager)\n    }\n\n    /**\n     * Apply the DOMMatrix value to the style of this Node's element.\n     */\n    applyTransform (domMatrix) {\n        var cssMatrixString = `matrix3d(\n            ${ domMatrix.m11 },\n            ${ domMatrix.m12 },\n            ${ domMatrix.m13 },\n            ${ domMatrix.m14 },\n            ${ domMatrix.m21 },\n            ${ domMatrix.m22 },\n            ${ domMatrix.m23 },\n            ${ domMatrix.m24 },\n            ${ domMatrix.m31 },\n            ${ domMatrix.m32 },\n            ${ domMatrix.m33 },\n            ${ domMatrix.m34 },\n            ${ domMatrix.m41 },\n            ${ domMatrix.m42 },\n            ${ domMatrix.m43 },\n            ${ domMatrix.m44 }\n        )`;\n\n        this.applyStyle('transform', cssMatrixString)\n    }\n\n    /**\n     * [applySize description]\n     */\n    applySize (size) {\n        const {x,y} = size\n\n        this.applyStyle('width', `${x}px`)\n        this.applyStyle('height', `${y}px`)\n\n        // NOTE: we ignore the Z axis on elements, since they are flat.\n    }\n\n    applyOpacity(opacity) {\n        this.applyStyle('opacity', opacity)\n    }\n\n    applyImperativeNodeProperties(node) {\n\n        // Only Node is Transformable\n        if (node instanceof Node) {\n            this.applyOpacity(node._properties.opacity)\n            this.applyTransform(node._properties.transform)\n        }\n\n        // But both Node and Scene are Sizeable\n        this.applySize(node._calculatedSize)\n    }\n\n    shouldRender() {\n        const task = Motor.addRenderTask(() => {\n            this.applyStyle('display', 'block')\n            Motor.removeRenderTask(task)\n        })\n    }\n\n    shouldNotRender() {\n        const task = Motor.addRenderTask(() => {\n            this.applyStyle('display', 'none')\n            Motor.removeRenderTask(task)\n        })\n    }\n}\n\nexport {ElementManager as default}\n"],"names":["this"],"mappings":"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"}