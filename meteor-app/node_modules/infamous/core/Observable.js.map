{"version":3,"file":"Observable.js","sources":["../../src/core/Observable.js"],"sourcesContent":["\nconst instanceofSymbol = Symbol('instanceofSymbol')\n\nconst ObservableMixin = base => {\n    class Observable extends base {\n\n        constructor(options = {}) {\n            super(options)\n        }\n\n        on(eventName, callback) {\n            if (!this._eventMap)\n                this._eventMap = new Map\n\n            if (!this._eventMap.has(eventName))\n                this._eventMap.set(eventName, [])\n\n            if (typeof callback == 'function')\n                this._eventMap.get(eventName).push(callback)\n            else\n                throw new Error('Expected a function in callback argument of Observable#on.')\n        }\n\n        off(eventName, callback) {\n            if (!this._eventMap || !this._eventMap.has(eventName)) return\n\n            const callbacks = this._eventMap.get(eventName)\n\n            if (callbacks.indexOf(callback) === -1) return\n\n            callbacks.splice(callbacks.indexOf(callback), 1)\n\n            if (callbacks.length === 0) this._eventMap.delete(eventName)\n\n            if (this._eventMap.size === 0) this._eventMap = null\n        }\n\n        triggerEvent(eventName, data) {\n            if (!this._eventMap || !this._eventMap.has(eventName)) return\n\n            const callbacks = this._eventMap.get(eventName)\n\n            for (let i=0, len=callbacks.length; i<len; i+=1) {\n                callbacks[i](data)\n            }\n        }\n    }\n\n    Object.defineProperty(Observable, Symbol.hasInstance, {\n        value: function(obj) {\n            if (this !== Observable) return Object.getPrototypeOf(Observable)[Symbol.hasInstance].call(this, obj)\n\n            let currentProto = obj\n\n            while(currentProto) {\n                const desc = Object.getOwnPropertyDescriptor(currentProto, \"constructor\")\n\n                if (desc && desc.value && desc.value.hasOwnProperty(instanceofSymbol))\n                    return true\n\n                currentProto = Object.getPrototypeOf(currentProto)\n            }\n\n            return false\n        }\n    })\n\n    Observable[instanceofSymbol] = true\n\n    return Observable\n}\n\nconst Observable = ObservableMixin(class{})\nObservable.mixin = ObservableMixin\n\nexport {Observable as default}\n"],"names":[],"mappings":"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"}